{"version":3,"file":"chrome-debugger.js","sourceRoot":"","sources":["../../src/plugin/chrome-debugger.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,iEAAsF;AACtF,6BAAsC;AAEtC;IAAoC,kCAA+B;IAIjE;QAAA,YACE,iBAAO,SACR;QAJM,kBAAY,GAAW,EAAE,CAAA;;IAIhC,CAAC;IACD,oCAAW,GAAX,UAAa,KAAa;QACxB,IAAI,CAAC,YAAY,GAAG,KAAK,IAAI,EAAE,CAAA;IACjC,CAAC;IACD,mCAAU,GAAV,UAAW,WAAmB,EAAE,aAAqB;QACnD,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,GAAG,aAAa,CAAA;IAChD,CAAC;IACD,2CAAkB,GAAlB,UAAoB,OAAe;QAAnC,iBAsBC;QArBC,IAAI,QAAQ,GAAG,OAAO,CAAA;QAEtB,MAAM;aACH,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC;aACvB,OAAO,CAAC,UAAC,MAAM;YACd,IAAI,MAAM,GAAG,KAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAA;YACtC,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,MAAM,CAAC,MAAI,MAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC5C,IAAI,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,sBAAsB,CAAC,CAAA;gBAChD,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;oBACV,QAAQ,GAAG,OAAO;yBACf,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC;yBAEvB,OAAO,CAAC,cAAc,EAAE,IAAI,CAAC,CAAA;gBAClC,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACN,IAAI,UAAU,GAAG,gBAAS,CAAC,WAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,CAAA;oBAC7C,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,EAAE,UAAU,CAAC,CAAA;gBAEhD,CAAC;YACH,CAAC;QACH,CAAC,CAAC,CAAA;QACJ,MAAM,CAAC,QAAQ,CAAA;IACjB,CAAC;IACK,mCAAU,GAAhB,UAAkB,OAAO;;gBACjB,OAAO,EAAE,QAAQ,EAAE,IAAI;;;;kCAAK,OAAO,qBAAP,OAAO,kBAAP,OAAO;wBACzC,QAAQ,CAAC,MAAM,CAAC;4BACd,IAAI,CAAC,gBAAgB,CAAC;gCACpB,OAAO,EAAE,uBAAuB;6BACjC,CAAC,CAAA;wBACJ,CAAC,CAAC,CAAA;wBACF,QAAQ,CAAC,OAAO,CAAC;4BACf,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAA;wBAC3B,CAAC,CAAC,CAAA;wBACK,WAAM,OAAO,CAAC,GAAG,CAAC;gCACvB,IAAI,CAAC,MAAM,EAAE;gCACb,OAAO,CAAC,MAAM,EAAE;gCAEhB,QAAQ,CAAC,MAAM,EAAE;6BAMlB,CAAC,EAAA;4BAVF,WAAO,SAUL,EAAA;;;;KACH;IACH,qBAAC;AAAD,CAAC,AA1DD,CAAoC,0CAA+B,GA0DlE;AA1DY,wCAAc","sourcesContent":["import { ChromeDebuggingProtocolDebugger } from 'xatom-debug-chrome-base/lib/debugger'\nimport { join, normalize } from 'path'\n\nexport class ChromeDebugger extends ChromeDebuggingProtocolDebugger {\n  public basePath: string\n  public mappingPaths: Object = {}\n  public serverUrl: string\n  constructor () {\n    super()\n  }\n  setMappings (value: Object) {\n    this.mappingPaths = value || {}\n  }\n  addMapping(mappingPath: string, mappingTarget: string) {\n    this.mappingPaths[mappingPath] = mappingTarget\n  }\n  getFilePathFromUrl (fileUrl: string): string {\n    let filePath = fileUrl\n    // console.log('maps', fileUrl, this.mappingPaths)\n    Object\n      .keys(this.mappingPaths)\n      .forEach((origin) => {\n        let target = this.mappingPaths[origin]\n        if (fileUrl.match(new RegExp(`^${origin}`))) {\n          let isUrl = target.match(/(http|https|ws):\\/\\//)\n          if (isUrl) {\n            filePath = fileUrl\n              .replace(origin, target)\n              // .replace(/\\?(.+)$/, '')\n              .replace(/([^:]\\/)\\/+/g, \"$1\")\n          } else {\n            let pathTarget = normalize(join(target, '/'))\n            filePath = fileUrl.replace(origin, pathTarget)\n            // console.log('replaced', fileUrl, filePath)\n          }\n        }\n      })\n    return filePath\n  }\n  async didConnect (domains): Promise<any> {\n    var { Runtime, Debugger, Page } = domains\n    Debugger.paused(() => {\n      Page.configureOverlay({\n        message: 'Paused from Atom Bugs'\n      })\n    })\n    Debugger.resumed(() => {\n      Page.configureOverlay({})\n    })\n    return await Promise.all([\n      Page.enable(),\n      Runtime.enable(),\n      // Runtime.runIfWaitingForDebugger(),\n      Debugger.enable(),\n      // Debugger.setPauseOnExceptions({ state: 'none' }),\n      // Debugger.setAsyncCallStackDepth({ maxDepth: 0 }),\n      // Debugger.setBreakpointsActive({\n      //   active: true\n      // })\n    ])\n  }\n}\n"]}